<main class="min-h-screen bg-gray-900/5 px-6 py-10 font-sans lg:px-12">

  <header class="p-6 text-center border-b border-slate-700 bg-slate-800/50 backdrop-blur-md sticky top-0 z-10">
    <h1 class="text-center text-4xl font-semibold text-sky-200">Welcome to the Uno Casino!</h1>
    <p *ngIf="currentUser()" class="mt-2 text-slate-400">
      Logged in as <span class="text-sky-400 font-semibold">{{ currentUser()?.username }}</span>
      | ELO: <span class="text-yellow-400">{{ currentUser()?.elo }}</span>
    </p>
    <app-toast
      [message]="wsService.notification()?.message || ''"
      [type]="wsService.notification()?.type || 'info'">
    </app-toast>
  </header>
  <div class="mx-auto max-w-7xl space-y-10 p-6">
      <section *ngIf="!isLoggedIn()" class="flex justify-center items-center py-10">
        <app-login (loginSuccess)="onLoginSuccess($event)"></app-login>
      </section>
    <!-- 3. LOBBY VIEW (Logged in, not in game) -->
    <div *ngIf="isLoggedIn() && !isInGame()" class="grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500">

      <!-- Queue Section -->
      <section class="lg:col-span-1 rounded-2xl border border-slate-700 bg-slate-800 p-8 shadow-xl flex flex-col items-center justify-center gap-6">
        <h2 class="text-2xl font-semibold text-white">Find a Match</h2>

        <div class="relative w-full aspect-video bg-slate-900/50 rounded-lg flex items-center justify-center border border-dashed border-slate-600">
          <p *ngIf="!isQueued()" class="text-slate-500">Ready to play?</p>
          <div *ngIf="isQueued()" class="text-center">
            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-sky-500 mb-2"></div>
            <p class="text-sky-400">Searching for opponents...</p>
            <p class="text-xs text-slate-500 mt-1">Position: {{ wsService.queuePosition() }}</p>
          </div>
        </div>

        <button
          *ngIf="!isQueued()"
          (click)="handleJoinQueue()"
          class="w-full py-4 px-6 rounded-xl bg-gradient-to-r from-blue-600 to-violet-600 font-bold text-lg hover:brightness-110 active:scale-95 transition-all shadow-lg shadow-blue-900/20">
          Join Queue
        </button>

        <button
          *ngIf="isQueued()"
          (click)="handleLeaveQueue()"
          class="w-full py-3 px-6 rounded-xl bg-red-500/10 text-red-400 border border-red-500/50 font-semibold hover:bg-red-500/20 transition-all">
          Cancel Search
        </button>
      </section>

      <!-- Leaderboard Section -->
      <section class="lg:col-span-2 rounded-2xl border border-slate-700 bg-slate-800 p-8 shadow-xl">
        <app-leaderboard></app-leaderboard>
      </section>
    </div>
    <div class="w-full min-h-full">
    @if (wsService.gameFound()) {
      <app-game></app-game>
    }
  </div>
  </div>
</main>
