<div class="flex flex-col h-[calc(100vh-160px)] w-full max-w-5xl mx-auto gap-4">

  <!-- Opponents Row -->
  <div class="flex justify-center gap-6 py-4">
    <div *ngFor="let p of ws.gameState().players"
         class="flex flex-col items-center p-3 rounded-lg border transition-all"
         [class.text-bold]="p.id === ws.gameState().players[ws.gameState().myIndex].id"
         [class.border-yellow-400]="ws.gameState().turnIndex === ws.gameState().players.indexOf(p)"
         [class.bg-yellow-500_20]="ws.gameState().turnIndex === ws.gameState().players.indexOf(p)"
         [class.border-transparent]="ws.gameState().turnIndex !== ws.gameState().players.indexOf(p)">

      <div class="w-12 h-12 rounded-full bg-slate-600 flex items-center justify-center text-white font-bold text-lg mb-2">
        {{ p.username.charAt(0).toUpperCase() }}
      </div>
      <div class="text-white font-semibold">{{ p.username }}</div>
      <div class="text-xs text-slate-400">{{ p.cardCount }} Cards</div>
    </div>
  </div>

  <!-- Game Board (Center) -->
  <div class="flex-1 bg-green-900/40 border border-green-800 rounded-3xl relative flex items-center justify-center shadow-inner">

    <!-- Direction Indicator -->
    <div class="absolute top-4 right-4 text-white/30 font-mono text-xs">
        Game ID: {{ ws.activeGameId() }} | {{ ws.gameState().reversed ? 'CCW ⟲' : 'CW ⟳' }}
    </div>

    <!-- Center Pile -->
    <div class="flex gap-8 items-center">
        <!-- Deck (Draw Pile) -->
        <div (click)="drawCard()"
             class="w-32 h-48 bg-slate-800 rounded-xl border-4 border-white shadow-2xl cursor-pointer hover:-translate-y-1 transition-transform flex items-center justify-center">
             <span class="text-slate-600 font-bold text-xl">UNO</span>
        </div>

        <!-- Discard Pile (Top Card) -->
        <div class="w-32 h-48 rounded-xl shadow-2xl flex items-center justify-center text-5xl font-bold border-4 border-white/20"
             [ngClass]="getCardInfo(ws.gameState().topCard).bg">
             {{ getCardInfo(ws.gameState().topCard).text }}
        </div>
    </div>

    <!-- Status Text -->
    <div class="absolute bottom-8 text-white font-bold text-xl drop-shadow-md">
        <span *ngIf="isMyTurn()" class="text-yellow-400 animate-pulse">YOUR TURN!</span>
        <span *ngIf="!isMyTurn()" class="text-slate-300">Waiting for {{ ws.gameState().players[ws.gameState().turnIndex]?.username }}...</span>
    </div>
  </div>

  <!-- My Hand -->
  <div class="flex justify-center -space-x-8 pb-4 overflow-x-auto min-h-[160px] px-8">
    <div *ngFor="let card of ws.currentHand()"
         (click)="playCard(card)"
         class="w-24 h-36 rounded-lg shadow-xl cursor-pointer hover:-translate-y-6 hover:z-10 transition-all border-2 border-slate-200 flex items-center justify-center text-3xl font-bold relative group"
         [ngClass]="getCardInfo(card).bg"
         [class.opacity-50]="!isMyTurn()">

      {{ getCardInfo(card).text }}

      <!-- Hover effect -->
      <div class="absolute inset-0 bg-black/0 group-hover:bg-white/10 rounded-lg"></div>
    </div>
  </div>

</div>
